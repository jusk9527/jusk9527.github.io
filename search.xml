<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>猿人学第一题解题思路</title>
      <link href="2021/08/18/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC%E4%B8%80%E9%A2%98/"/>
      <url>2021/08/18/%E7%8C%BF%E4%BA%BA%E5%AD%A6%E7%AC%AC%E4%B8%80%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><a href="https://match.yuanrenxue.com/match/1">js 混淆 - 源码乱码</a></p><p>这是一道js 混淆的简单题,下面我们来看看如何进行逆向它，最后拿到数据</p><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><h4 id="拿到题目-查看数据请求携带参数"><a href="#拿到题目-查看数据请求携带参数" class="headerlink" title="拿到题目,查看数据请求携带参数"></a>拿到题目,查看数据请求携带参数</h4><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210818114110.png" alt="image-20210818114104881"></p><h4 id="直接搜索特殊关键字定位-m、-发现都不行"><a href="#直接搜索特殊关键字定位-m、-发现都不行" class="headerlink" title="直接搜索特殊关键字定位 m、| 发现都不行"></a>直接搜索特殊关键字定位 m、| 发现都不行</h4><h4 id="那么定位到request请求跟踪参数来源"><a href="#那么定位到request请求跟踪参数来源" class="headerlink" title="那么定位到request请求跟踪参数来源"></a>那么定位到<code>request</code>请求跟踪参数来源</h4><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210818114509.png" alt="image-20210818114509021"></p><h4 id="进去发现混淆过，那么去混淆看下"><a href="#进去发现混淆过，那么去混淆看下" class="headerlink" title="进去发现混淆过，那么去混淆看下"></a>进去发现混淆过，那么去混淆看下</h4><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210818114645.png" alt="image-20210818114645381"></p><h4 id="重要参数一览无余"><a href="#重要参数一览无余" class="headerlink" title="重要参数一览无余"></a>重要参数一览无余</h4><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210818114900.png" alt="image-20210818114859949"></p><h4 id="断点下，在控制台打印我们需要的参数"><a href="#断点下，在控制台打印我们需要的参数" class="headerlink" title="断点下，在控制台打印我们需要的参数"></a>断点下，在控制台打印我们需要的参数</h4><p><code>windows.f</code>发现为</p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812181824.png" alt="image-20210812181824024"></p><p>这个值和发送请求的值一样。了解到<code>window.f</code> 就是我们需要去求的值</p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812181904.png" alt="image-20210812181904614"></p><p>但是我们搜索<code>window.f</code>却没有。那么我们知道肯定<code>js</code> 混淆后替换了或怎么样了</p><p>那么我们看下参数进过了哪些传递到了那里</p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210818120100.png" alt="image-20210818120100890"></p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210818120039.png" alt="image-20210818120039114"></p><p>原来是从这个地方来的，这里有个带<code>&lt;script&gt;</code>标签的<code>js</code></p><h4 id="这时候我们需要将源码全下载下来。放到webStorm分析。"><a href="#这时候我们需要将源码全下载下来。放到webStorm分析。" class="headerlink" title="这时候我们需要将源码全下载下来。放到webStorm分析。"></a>这时候我们需要将源码全下载下来。放到<code>webStorm</code>分析。</h4><p>查看<code>eval()</code>。发现有两处比较可疑</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">eval</span><span class="token punctuation">(</span><span class="token function">atob</span><span class="token punctuation">(</span>window<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token constant">J</span><span class="token punctuation">(</span><span class="token string">'0x0'</span><span class="token punctuation">,</span><span class="token string">']dQW'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token constant">J</span><span class="token punctuation">(</span><span class="token string">'0x1'</span><span class="token punctuation">,</span><span class="token string">'GTu!'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'\x27'</span><span class="token operator">+</span>mw<span class="token operator">+</span><span class="token string">'\x27'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token string">''</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812182702.png" alt="image-20210812182702701"></p><p>第一个发现使用了<a href="https://www.runoob.com/jsref/met-win-atob.html">atob() 函数</a>这个函数是用于解码使用 base-64 编码的字符串。</p><p>控制台执行</p><pre class="line-numbers language-none"><code class="language-none">atob(window[&#39;b&#39;])<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>发现字符串代码</p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812183138.png" alt="image-20210812183138839"></p><pre class="line-numbers language-none"><code class="language-none">J(&#39;0x0&#39;, &#39;]dQW&#39;)J(&#39;0x1&#39;, &#39;GTu!&#39;)&#39;\x27&#39; + mw + &#39;\x27<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812183902.png" alt="image-20210812183902082"></p><p>发现<code>J</code>  未定义</p><p>我们查找<code>J</code> 发现就在上一段代码。其实就是中</p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812184453.png" alt="image-20210812184453606"></p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812185536.png" alt="image-20210812185536435"></p><p>执行这段代码在控制台</p><p>之后发现</p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812185905.png" alt="image-20210812185905910"></p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812190125.png" alt="image-20210812190125840"></p><p>那么还原这段代码就是</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">eval</span><span class="token punctuation">(</span><span class="token function">atob</span><span class="token punctuation">(</span>window<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"replace"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"mwqqppz"</span><span class="token punctuation">,</span> <span class="token string">'mw'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>再简化</p><pre class="line-numbers language-none"><code class="language-none">eval(atob(window[&#39;b&#39;]).replace(&quot;mwqqppz&quot;, &#39;mw&#39;));<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>懂了就是将</p><pre class="line-numbers language-none"><code class="language-none">atob(window[&#39;b&#39;])  字符串中的替换&#39;mwqqppz&#39; 替换为’mv‘<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>那么尝试解密下内容</p><p><code>atob(window[&#39;b&#39;])</code></p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812190738.png" alt="image-20210812190738381"></p><p>IDE 里面美化分析一波</p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812190903.png" alt="image-20210812190903338"></p><p>发现 <code>window.f</code> 内容是<code>hex_md5(mwqqppz)</code>;</p><p><code>mwqqppz</code>是不是特别熟悉。就是上面会替换 <code>mw</code>的那个地方</p><p>但是<code>mwqqppz</code>到底是什么值呢，这个不得而知。</p><p>我们回过去在看</p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812191516.png" alt="image-20210812191516024"></p><p><code>mv</code> 就是oo0O0(mw) 的一个形参</p><p>先看下<code>mv</code> 是什么吧，先弄清楚oo0O0函数在哪被调用了不就清楚了</p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812192300.png" alt="image-20210812192300596"></p><p>发现里面调用了。解密下</p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812192410.png" alt="image-20210812192410317"></p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812192508.png" alt="image-20210812192508825"></p><p>发现参数是</p><pre class="line-numbers language-none"><code class="language-none">Date.parse(new Date()) + 100000000   的字符串<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>那么回到原来这段代码就能知道含义了</p><pre class="line-numbers language-none"><code class="language-none">eval(atob(window[&#39;b&#39;]).replace(&quot;mwqqppz&quot;, &#39;mw&#39;));<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>就是将<code>window[&#39;b&#39;]</code> 的代码中的<code>mwqqppz</code>替换为<code>mw</code>。<code>mw</code>是 <code>Date.parse(new Date()) + 100000000   的字符串</code>那么<code>mwqqppz</code>也就是那个<code>mv</code>的时间戳字符串</p><p>好了。所有的谜题都解决了</p><p>我们知道之前 </p><pre class="line-numbers language-none"><code class="language-none">c67463479cac28f59ab163b50006a46c丨1628864679<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812194441.png" alt="image-20210812194441057"></p><p>我们执行下之前<code>hex_md5(mwqqppz);</code> 的函数看与结果是否一样</p><p>还是之前的时间戳</p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812193342.png" alt="image-20210812193342848"></p><p><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210812194615.png" alt="image-20210812194615385"></p><p>完全一致</p><h3 id="最后解题"><a href="#最后解题" class="headerlink" title="最后解题"></a>最后解题</h3><h4 id="js-代码求解"><a href="#js-代码求解" class="headerlink" title="js 代码求解"></a>js 代码求解</h4><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token string">'use strict'</span><span class="token punctuation">;</span><span class="token comment">/** @type &#123;number&#125; */</span><span class="token keyword">var</span> hexcase <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">/** @type &#123;string&#125; */</span><span class="token keyword">var</span> b64pad <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><span class="token comment">/** @type &#123;number&#125; */</span><span class="token keyword">var</span> chrsz <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span><span class="token comment">/** * @param &#123;string&#125; s * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">hex_md5</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token function">binl2hex</span><span class="token punctuation">(</span><span class="token function">core_md5</span><span class="token punctuation">(</span><span class="token function">str2binl</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>length <span class="token operator">*</span> chrsz<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;string&#125; s * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">b64_md5</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token function">binl2b64</span><span class="token punctuation">(</span><span class="token function">core_md5</span><span class="token punctuation">(</span><span class="token function">str2binl</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>length <span class="token operator">*</span> chrsz<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;string&#125; s * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">str_md5</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token function">binl2str</span><span class="token punctuation">(</span><span class="token function">core_md5</span><span class="token punctuation">(</span><span class="token function">str2binl</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>length <span class="token operator">*</span> chrsz<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;string&#125; key * @param &#123;string&#125; data * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">hex_hmac_md5</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token function">binl2hex</span><span class="token punctuation">(</span><span class="token function">core_hmac_md5</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;string&#125; key * @param &#123;string&#125; data * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">b64_hmac_md5</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token function">binl2b64</span><span class="token punctuation">(</span><span class="token function">core_hmac_md5</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;string&#125; key * @param &#123;string&#125; data * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">str_hmac_md5</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token function">binl2str</span><span class="token punctuation">(</span><span class="token function">core_hmac_md5</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">md5_vm_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token function">hex_md5</span><span class="token punctuation">(</span><span class="token string">"abc"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"900150983cd24fb0d6963f7d28e17f72"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;!Object&#125; x * @param &#123;number&#125; len * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">core_md5</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> len</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  x<span class="token punctuation">[</span>len <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token number">128</span> <span class="token operator">&lt;&lt;</span> len <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  x<span class="token punctuation">[</span><span class="token punctuation">(</span>len <span class="token operator">+</span> <span class="token number">64</span> <span class="token operator">>>></span> <span class="token number">9</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> len<span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1732584193</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">271733879</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1732584194</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token number">271733878</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> x<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> olda <span class="token operator">=</span> a<span class="token punctuation">;</span>    <span class="token keyword">var</span> oldb <span class="token operator">=</span> b<span class="token punctuation">;</span>    <span class="token keyword">var</span> oldc <span class="token operator">=</span> c<span class="token punctuation">;</span>    <span class="token keyword">var</span> oldd <span class="token operator">=</span> d<span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">680976936</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">389564586</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">606105819</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1044525330</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">176418897</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">1200080426</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1473231341</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">45705983</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1770035416</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1958414417</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">42063</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1990404162</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1804660682</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">40341101</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1502002290</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">1236535329</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">165796510</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1069501632</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">643717713</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">373897302</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">701558691</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">38016083</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">660478335</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">405537848</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">568446438</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1019803690</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">187363961</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">1163531501</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1444681467</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">51403784</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1735328473</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1921207734</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">378558</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2022574463</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">1839030562</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">35309556</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1530992060</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">1272893353</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">155497632</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1094730640</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">681279174</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">358537222</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">722881979</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">76029189</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">640364487</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">421815835</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">530742520</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">995338651</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">198630844</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11261161415</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1416354905</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">57434055</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1700485571</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1894446606</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1051523</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2054922799</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1873313359</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">30611744</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1560198380</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">1309151649</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">145523070</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1120210379</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">718787259</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> x<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">343485551</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a <span class="token operator">=</span> <span class="token function">safe_add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> olda<span class="token punctuation">)</span><span class="token punctuation">;</span>    b <span class="token operator">=</span> <span class="token function">safe_add</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> oldb<span class="token punctuation">)</span><span class="token punctuation">;</span>    c <span class="token operator">=</span> <span class="token function">safe_add</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> oldc<span class="token punctuation">)</span><span class="token punctuation">;</span>    d <span class="token operator">=</span> <span class="token function">safe_add</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> oldd<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token function">Array</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;number&#125; q * @param &#123;number&#125; a * @param &#123;number&#125; b * @param &#123;number&#125; x * @param &#123;number&#125; s * @param &#123;number&#125; t * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">md5_cmn</span><span class="token punctuation">(</span><span class="token parameter">q<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">,</span> s<span class="token punctuation">,</span> t</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token function">safe_add</span><span class="token punctuation">(</span><span class="token function">bit_rol</span><span class="token punctuation">(</span><span class="token function">safe_add</span><span class="token punctuation">(</span><span class="token function">safe_add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">safe_add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;number&#125; a * @param &#123;number&#125; b * @param &#123;number&#125; c * @param &#123;number&#125; d * @param &#123;undefined&#125; x * @param &#123;number&#125; s * @param &#123;number&#125; t * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">md5_ff</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">,</span> s<span class="token punctuation">,</span> t</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token function">md5_cmn</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> c <span class="token operator">|</span> <span class="token operator">~</span>b <span class="token operator">&amp;</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">,</span> s<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;number&#125; a * @param &#123;number&#125; b * @param &#123;number&#125; c * @param &#123;number&#125; d * @param &#123;undefined&#125; x * @param &#123;number&#125; s * @param &#123;number&#125; t * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">md5_gg</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">,</span> s<span class="token punctuation">,</span> t</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token function">md5_cmn</span><span class="token punctuation">(</span>b <span class="token operator">&amp;</span> d <span class="token operator">|</span> c <span class="token operator">&amp;</span> <span class="token operator">~</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">,</span> s<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;number&#125; a * @param &#123;number&#125; b * @param &#123;number&#125; c * @param &#123;number&#125; d * @param &#123;undefined&#125; x * @param &#123;number&#125; s * @param &#123;number&#125; t * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">md5_hh</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">,</span> s<span class="token punctuation">,</span> t</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token function">md5_cmn</span><span class="token punctuation">(</span>b <span class="token operator">^</span> c <span class="token operator">^</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">,</span> s<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;number&#125; a * @param &#123;number&#125; b * @param &#123;number&#125; c * @param &#123;number&#125; d * @param &#123;undefined&#125; x * @param &#123;number&#125; s * @param &#123;number&#125; t * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">md5_ii</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">,</span> s<span class="token punctuation">,</span> t</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token function">md5_cmn</span><span class="token punctuation">(</span>c <span class="token operator">^</span> <span class="token punctuation">(</span>b <span class="token operator">|</span> <span class="token operator">~</span>d<span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">,</span> s<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;string&#125; key * @param &#123;string&#125; data * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">core_hmac_md5</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">var</span> bkey <span class="token operator">=</span> <span class="token function">str2binl</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>bkey<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    bkey <span class="token operator">=</span> <span class="token function">core_md5</span><span class="token punctuation">(</span>bkey<span class="token punctuation">,</span> key<span class="token punctuation">.</span>length <span class="token operator">*</span> chrsz<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token comment">/** @type &#123;!Array&#125; */</span>  <span class="token keyword">var</span> ipad <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;!Array&#125; */</span>  <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/** @type &#123;number&#125; */</span>    ipad<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> bkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">909522486</span><span class="token punctuation">;</span>    <span class="token comment">/** @type &#123;number&#125; */</span>    d<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> bkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token number">1549556828</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">var</span> hash <span class="token operator">=</span> <span class="token function">core_md5</span><span class="token punctuation">(</span>ipad<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token function">str2binl</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">512</span> <span class="token operator">+</span> data<span class="token punctuation">.</span>length <span class="token operator">*</span> chrsz<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token function">core_md5</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>hash<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">512</span> <span class="token operator">+</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;number&#125; x * @param &#123;number&#125; y * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">safe_add</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">&amp;</span> <span class="token number">65535</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y <span class="token operator">&amp;</span> <span class="token number">65535</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  <span class="token keyword">var</span> len <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>c <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> len <span class="token operator">&lt;&lt;</span> <span class="token number">16</span> <span class="token operator">|</span> c <span class="token operator">&amp;</span> <span class="token number">65535</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;number&#125; num * @param &#123;number&#125; cnt * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">bit_rol</span><span class="token punctuation">(</span><span class="token parameter">num<span class="token punctuation">,</span> cnt</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> num <span class="token operator">&lt;&lt;</span> cnt <span class="token operator">|</span> num <span class="token operator">>>></span> <span class="token number">32</span> <span class="token operator">-</span> cnt<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;string&#125; str * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">str2binl</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">/** @type &#123;!Array&#125; */</span>  <span class="token keyword">var</span> bin <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  <span class="token keyword">var</span> mask <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> chrsz<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> str<span class="token punctuation">.</span>length <span class="token operator">*</span> chrsz<span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> chrsz<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    bin<span class="token punctuation">[</span>i <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|=</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i <span class="token operator">/</span> chrsz<span class="token punctuation">)</span> <span class="token operator">&amp;</span> mask<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">%</span> <span class="token number">32</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> bin<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;!Object&#125; bin * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">binl2str</span><span class="token punctuation">(</span><span class="token parameter">bin</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">/** @type &#123;string&#125; */</span>  <span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  <span class="token keyword">var</span> mask <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> chrsz<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> bin<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> chrsz<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/** @type &#123;string&#125; */</span>    str <span class="token operator">=</span> str <span class="token operator">+</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>bin<span class="token punctuation">[</span>i <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">>>></span> i <span class="token operator">%</span> <span class="token number">32</span> <span class="token operator">&amp;</span> mask<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> str<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;!Object&#125; binarray * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">binl2hex</span><span class="token punctuation">(</span><span class="token parameter">binarray</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">/** @type &#123;string&#125; */</span>  <span class="token keyword">var</span> hex_tab <span class="token operator">=</span> hexcase <span class="token operator">?</span> <span class="token string">"0123456789ABCDEF"</span> <span class="token operator">:</span> <span class="token string">"0123456789abcdef"</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;string&#125; */</span>  <span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> binarray<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/** @type &#123;string&#125; */</span>    str <span class="token operator">=</span> str <span class="token operator">+</span> <span class="token punctuation">(</span>hex_tab<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>binarray<span class="token punctuation">[</span>i <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">>></span> i <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">&amp;</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">+</span> hex_tab<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>binarray<span class="token punctuation">[</span>i <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">>></span> i <span class="token operator">%</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">&amp;</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> str<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * @param &#123;!Object&#125; binarray * @return &#123;?&#125; */</span><span class="token keyword">function</span> <span class="token function">binl2b64</span><span class="token punctuation">(</span><span class="token parameter">binarray</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">/** @type &#123;string&#125; */</span>  <span class="token keyword">var</span> raw_composed_type <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;string&#125; */</span>  <span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  <span class="token comment">/** @type &#123;number&#125; */</span>  <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> binarray<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span> i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/** @type &#123;number&#125; */</span>    <span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token punctuation">(</span>binarray<span class="token punctuation">[</span>i <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">8</span> <span class="token operator">*</span> <span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span> <span class="token operator">|</span> <span class="token punctuation">(</span>binarray<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">8</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span> <span class="token operator">|</span> binarray<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">>></span> <span class="token number">8</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">;</span>    <span class="token comment">/** @type &#123;number&#125; */</span>    <span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">+</span> j <span class="token operator">*</span> <span class="token number">6</span> <span class="token operator">></span> binarray<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        str <span class="token operator">=</span> str <span class="token operator">+</span> b64pad<span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token comment">/** @type &#123;string&#125; */</span>        str <span class="token operator">=</span> str <span class="token operator">+</span> raw_composed_type<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>e <span class="token operator">>></span> <span class="token number">6</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">-</span> j<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> str<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">get_windos_f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">var</span> timestamp <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">100000000</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// var res = 1628863165000;</span>  <span class="token comment">// console.log(res);</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">hex_md5</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  obj<span class="token punctuation">.</span>res1 <span class="token operator">=</span> <span class="token function">hex_md5</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  obj<span class="token punctuation">.</span>res2 <span class="token operator">=</span> <span class="token punctuation">(</span>timestamp<span class="token operator">/</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> obj<span class="token punctuation">&#125;</span><span class="token comment">// var timestamp = Date.parse(new Date()) + 100000000;</span><span class="token comment">// console.log(timestamp);</span><span class="token comment">//</span><span class="token comment">//</span><span class="token comment">// // var res = 1628863165000;</span><span class="token comment">// // console.log(res);</span><span class="token comment">// console.log(hex_md5(timestamp.toString()));</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="python-求解"><a href="#python-求解" class="headerlink" title="python 求解"></a>python 求解</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> execjs<span class="token keyword">import</span> timeheaders <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'authority'</span><span class="token punctuation">:</span> <span class="token string">'match.yuanrenxue.com'</span><span class="token punctuation">,</span>    <span class="token string">'sec-ch-ua'</span><span class="token punctuation">:</span> <span class="token string">'"Chromium";v="92", " Not A;Brand";v="99", "Google Chrome";v="92"'</span><span class="token punctuation">,</span>    <span class="token string">'accept'</span><span class="token punctuation">:</span> <span class="token string">'application/json, text/javascript, */*; q=0.01'</span><span class="token punctuation">,</span>    <span class="token string">'dnt'</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>    <span class="token string">'x-requested-with'</span><span class="token punctuation">:</span> <span class="token string">'XMLHttpRequest'</span><span class="token punctuation">,</span>    <span class="token string">'sec-ch-ua-mobile'</span><span class="token punctuation">:</span> <span class="token string">'?0'</span><span class="token punctuation">,</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'yuanrenxue.project'</span><span class="token punctuation">,</span>    <span class="token string">'sec-fetch-site'</span><span class="token punctuation">:</span> <span class="token string">'same-origin'</span><span class="token punctuation">,</span>    <span class="token string">'sec-fetch-mode'</span><span class="token punctuation">:</span> <span class="token string">'cors'</span><span class="token punctuation">,</span>    <span class="token string">'sec-fetch-dest'</span><span class="token punctuation">:</span> <span class="token string">'empty'</span><span class="token punctuation">,</span>    <span class="token string">'referer'</span><span class="token punctuation">:</span> <span class="token string">'https://match.yuanrenxue.com/match/1'</span><span class="token punctuation">,</span>    <span class="token string">'accept-language'</span><span class="token punctuation">:</span> <span class="token string">'zh-CN,zh;q=0.9,en;q=0.8'</span><span class="token punctuation">,</span>    <span class="token string">'cookie'</span><span class="token punctuation">:</span> <span class="token string">'Hm_lvt_c99546cf032aaa5a679230de9a95c7db=1628664095; no-alert3=true; Hm_lvt_0362c7a08a9a04ccf3a8463c590e1e2f=1628664332; m=bff0873b5164fa7c64b08d88344343b7|1628669372000; Hm_lvt_9bcbda9cbf86757998a2339a0437208e=1628670722; Hm_lpvt_9bcbda9cbf86757998a2339a0437208e=1628677301; Hm_lpvt_0362c7a08a9a04ccf3a8463c590e1e2f=1628763084; Hm_lpvt_c99546cf032aaa5a679230de9a95c7db=1628821487'</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token string">"./windows_f结果.js"</span><span class="token keyword">def</span> <span class="token function">get_result</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token builtin">sum</span> <span class="token operator">=</span> <span class="token number">0</span>    num <span class="token operator">=</span> <span class="token number">0</span>    ctx <span class="token operator">=</span> execjs<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    res <span class="token operator">=</span> ctx<span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token string">'get_windos_f'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        params <span class="token operator">=</span> <span class="token punctuation">(</span>            <span class="token punctuation">(</span><span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token string">'&#123;0&#125;\u4E28&#123;1&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token string">'res1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> res<span class="token punctuation">[</span><span class="token string">'res2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token string">'page'</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>        <span class="token punctuation">)</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://match.yuanrenxue.com/api/match/1'</span><span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span>params<span class="token operator">=</span>params<span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            num <span class="token operator">+=</span> <span class="token number">1</span>            <span class="token builtin">sum</span> <span class="token operator">+=</span> j<span class="token punctuation">[</span><span class="token string">"value"</span><span class="token punctuation">]</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    avg <span class="token operator">=</span> <span class="token builtin">sum</span> <span class="token operator">/</span> num    <span class="token keyword">return</span> avgres <span class="token operator">=</span> get_result<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"结果："</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 4700.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><p><a href="http://jsnice.org/">http://jsnice.org/</a></p><p><a href="http://tool.yuanrenxue.com/deobfuscator">http://tool.yuanrenxue.com/deobfuscator</a></p>]]></content>
      
      
      <categories>
          
          <category> 猿人学爬虫 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>supervisor 使用技巧</title>
      <link href="2021/02/03/supervisor%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/"/>
      <url>2021/02/03/supervisor%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>以前后台经常这样启动一个程序</p><pre class="line-numbers language-none"><code class="language-none">nohup your-program &amp; &gt; nohup.log &amp;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>发现这样这样非常不好易于管理, 在使用<strong>supervisor</strong>之后,发现有以下<strong>优点</strong></p><ol><li>可以将非后台运行程序后台运行</li><li>自动监控，重启进程</li><li>方便集成多个程序一起管理</li></ol><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p><a href="http://supervisord.org/">Supervisor</a>是一个客户端/服务器系统，它允许用户在类unix操作系统上控制多个进程</p><h4 id="supervisor主要包含以下四个部分"><a href="#supervisor主要包含以下四个部分" class="headerlink" title="supervisor主要包含以下四个部分"></a>supervisor主要包含以下四个部分</h4><ul><li><strong>supervisord</strong>：这个是supervisor服务的主要<strong>管理器</strong>，负责管理我们配置的子进程，包括重启崩溃或异常退出的子进程，同时也响应来自客户端的请求</li><li><strong>supervisorctl</strong>：supervisord服务的<strong>客户端命令行</strong>。听过这个，我们可以获得由主进程控制的子进程的状态，停止和启动子进程，并获得主进程的运行列表。<br><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210226113425.png"><br><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210226114140.png"></li><li><strong>Web Server</strong>：和supervisorctl功能娉美。这个是通过web界面查看和控制进程状态。<br><img src="https://cdn.jsdelivr.net/gh/jusk9527/images/data/20210226113107.png"></li><li><strong>XML-RPC Interface</strong>：服务于web UI的同一个HTTP服务器提供一个XML-RPC接口，可以用来询问和控制管理程序及其运行的程序</li></ul><h4 id="运行环境"><a href="#运行环境" class="headerlink" title="运行环境"></a>运行环境</h4><p>supervisor可以运行在大多数类UNIX系统，但是不能运行在任何windows系统，Supervisor运行在python3版本3.4或更高版本以及python2版本2.7上工作。</p><h3 id="安装启动"><a href="#安装启动" class="headerlink" title="安装启动"></a>安装启动</h3><ul><li>查看python 版本</li></ul><pre class="line-numbers language-none"><code class="language-none">python -VPython 2.7.5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>如果python 版本低于2.6 的话</li></ul><pre class="line-numbers language-none"><code class="language-none">yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel -y libffi-develwget https:&#x2F;&#x2F;www.python.org&#x2F;ftp&#x2F;python&#x2F;3.6.8&#x2F;Python-3.6.8.tar.xztar xf Python-3.6.8.tar.xzcd Python-3.6.8.&#x2F;configure --prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;python368make &amp;&amp; make installecho &#39;export PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;python368&#x2F;bin:$PATH&#39; &gt;&gt; &#x2F;etc&#x2F;profilesource &#x2F;etc&#x2F;profilepython3 -V<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>使用 pip 来安装，前提要保证pip版本大于2.6</li></ul><pre class="line-numbers language-none"><code class="language-none">sudo pip install supervisor# 可能你会收到类似的报错：Supervisor requires Python 2.4 or later but does not work on any version of Python 3.  You are using version 3.4.3 (default, Oct 28 2017, 20:59:04)# 可以手动安装新版 Supervisor，它支持 Python3：pip install git+https:&#x2F;&#x2F;github.com&#x2F;Supervisor&#x2F;supervisor# 设置环境变量：vim ~&#x2F;.bash_profile在后面补充： PATH&#x3D;$PATH:$HOME&#x2F;bin:&#x2F;usr&#x2F;local&#x2F;python&#x2F;binsource ~&#x2F;.bash_profile<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><pre class="line-numbers language-none"><code class="language-none">echo_supervisord_conf &gt; &#x2F;etc&#x2F;supervisord.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>打开配置文件：</p><pre class="line-numbers language-none"><code class="language-none">vim &#x2F;etc&#x2F;supervisord.conf[unix_http_server]file&#x3D;&#x2F;tmp&#x2F;supervisor.sock   ; UNIX socket 文件，supervisorctl 会使用;chmod&#x3D;0700                 ; socket 文件的 mode，默认是 0700;chown&#x3D;nobody:nogroup       ; socket 文件的 owner，格式： uid:gid;username&#x3D;user              ; default is no username (open server);password&#x3D;123               ; default is no password (open server);[inet_http_server]         ; HTTP 服务器，提供 web 管理界面;port&#x3D;127.0.0.1:9001        ; Web 管理后台运行的 IP 和端口，如果开放到公网，需要注意安全性;username&#x3D;user              ; 登录管理后台的用户名;password&#x3D;123               ; 登录管理后台的密码[supervisord]logfile&#x3D;&#x2F;tmp&#x2F;supervisord.log ; 日志文件，默认是 $CWD&#x2F;supervisord.loglogfile_maxbytes&#x3D;50MB        ; 日志文件大小，超出会 rotate，默认 50MBlogfile_backups&#x3D;10           ; 日志文件保留备份数量默认 10loglevel&#x3D;info                ; 日志级别，默认 info，其它: debug,warn,tracepidfile&#x3D;&#x2F;tmp&#x2F;supervisord.pid ; pid 文件nodaemon&#x3D;false               ; 是否在前台启动，默认是 false，即以 daemon 的方式启动minfds&#x3D;1024                  ; 可以打开的文件描述符的最小值，默认 1024minprocs&#x3D;200                 ; 可以打开的进程数的最小值，默认 200; the below section must remain in the config file for RPC; (supervisorctl&#x2F;web interface) to work, additional interfaces may be; added by defining them in separate rpcinterface: sections[rpcinterface:supervisor]supervisor.rpcinterface_factory &#x3D; supervisor.rpcinterface:make_main_rpcinterface[supervisorctl]serverurl&#x3D;unix:&#x2F;&#x2F;&#x2F;tmp&#x2F;supervisor.sock ; 通过 UNIX socket 连接 supervisord，路径与 unix_http_server 部分的 file 一致;serverurl&#x3D;http:&#x2F;&#x2F;127.0.0.1:9001 ; 通过 HTTP 的方式连接 supervisord;包含其他的配置文件[include]files &#x3D; relative&#x2F;directory&#x2F;*.ini    ; 可以是 *.conf 或 *.ini<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="配置管理的进程"><a href="#配置管理的进程" class="headerlink" title="配置管理的进程"></a>配置管理的进程</h4><pre class="line-numbers language-none"><code class="language-none">vim supervisord.conf# 找到最后一行，并取消注释和添加：[include]files &#x3D; &#x2F;etc&#x2F;supervisor&#x2F;*.conf$ mkdir &#x2F;etc&#x2F;supervisor$ cd &#x2F;etc&#x2F;suervisor$ vim Djnago.conf# 填入以下内容：[program:Djagno]command&#x3D;&#x2F;root&#x2F;.virtualenvs&#x2F;xxx&#x2F;bin&#x2F;gunicorn xxx.wsgi:application -b 0.0.0.0:8004  ; 被监控的进程路径  ; 被监控的进程路径directory&#x3D;&#x2F;mnt&#x2F;hao&#x2F;server&#x2F;               ; 执行前要不要先cd到目录$autostart&#x3D;true                ; 随着supervisord的启动而启动autorestart&#x3D;true              ; 自动重启。。当然要选上了startretries&#x3D;10               ; 启动失败时的最多重试次数exitcodes&#x3D;0                   ; 正常退出代码stopsignal&#x3D;KILL               ; 用来杀死进程的信号stopwaitsecs&#x3D;10               ; 发送SIGKILL前的等待时间redirect_stderr&#x3D;true          ; 重定向stderr到stdoutstdout_logfile&#x3D;..&#x2F;..&#x2F;log&#x2F;django&#x2F;django.log                      ；输出日志stderr_logfile&#x3D;..&#x2F;..&#x2F;log&#x2F;django&#x2F;django.log                       ; 错误日志; 默认为 false，如果设置为 true，当进程收到 stop 信号时，会自动将该信号发给该进$stopasgroup&#x3D;true             ; send stop signal to the UNIX process; 默认为 false，如果设置为 true，当进程收到 kill 信号时，会自动将该信号发给该进$killasgroup&#x3D;true             ; SIGKILL the UNIX process group (def false)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里说明下: <strong>environment</strong>没啥用。<strong>command</strong> 里面写好环境比较好</p><h4 id="启动-Supervisor"><a href="#启动-Supervisor" class="headerlink" title="启动 Supervisor"></a>启动 Supervisor</h4><p>Supervisor 有两个主要的组成部分：</p><ol><li>supervisord，运行 Supervisor 时会启动一个进程 supervisord，它负责启动所管理的进程，并将所管理的进程作为自己的子进程来启动，而且可以在所管理的进程出现崩溃时自动重启</li><li>supervisorctl，是命令行管理工具，可以用来执行 stop、start、restart 等命令，来对这些子进程进行管理。</li></ol><pre class="line-numbers language-none"><code class="language-none">supervisord -c &#x2F;etc&#x2F;supervisord.conf                                   # 固定配置文件夹启动supervisorctl -c &#x2F;etc&#x2F;supervisord.conf status                     # 查看状态<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>命令参数意义可参考上面 <strong>supervisor主要包含以下四个部分</strong></li></ul><h3 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h3><ol><li>在启动 supervisorctl 的时候可能会接受到 refuse connection 的报错，解决办法：</li></ol><pre class="line-numbers language-none"><code class="language-none"># 找到 supervisor.sock 的地址$ find &#x2F; -name supervisor.sock# unlink 掉它，*** 换成真实地址$ unlink &#x2F;***&#x2F;supervisor.sock&#96;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>还遇到了另外一个问题，在 supervisor 运行一段时间后，web 端会访问不了，在后台企图通过 supervisorctl -c /etc/supervisord.conf 登录，发现还是报 refuse connection 的错误，还有<pre class="line-numbers language-none"><code class="language-none">Error: Another program is already listening on a port that one of our HTTP servers is configured to use. Shut this program down first before starting supervisord.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>尝试将[supervisorctl] 里面的属性 serverurl 修改成 unix 前缀，如 unix:///tmp/supervisord.sock，过一段时间再做观察。</li></ol><h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><ol><li><a href="https://my.oschina.net/goskyblue/blog/380828">https://my.oschina.net/goskyblue/blog/380828</a></li><li><a href="https://zhuanlan.zhihu.com/p/36459081">https://zhuanlan.zhihu.com/p/36459081</a></li></ol>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
